From f7b1ad0958e194dc86ae11a153ca1b5b88d10c9e Mon Sep 17 00:00:00 2001
From: Byron McCollum <byron.mccollum@rackspace.com>
Date: Sat, 16 Jan 2016 22:09:50 -0600
Subject: [PATCH] Adjust permission of /etc/ceph to allow Cinder to create Ceph
 Volumes

Cinder Volume needs access to /etc/ceph to create Ceph Volumes. This
change passes `conf_directory_group` and `conf_directory_mode` as
role parameters to adjust permissions accordingly.

Note: This depends on an upstream pull request for the ceph-common role

https://github.com/ceph/ceph-ansible/pull/485

Fixes: #747
---
 rpcd/playbooks/setup-maas.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/rpcd/playbooks/setup-maas.yml b/rpcd/playbooks/setup-maas.yml
index 6a90483..c67ca33 100644
--- a/rpcd/playbooks/setup-maas.yml
+++ b/rpcd/playbooks/setup-maas.yml
@@ -19,7 +19,7 @@
 - name: Install Ceph dependencies
   hosts: osds_all:mons_all:&hosts
   roles:
-    - role: ceph-common
+    - { role: "ceph-common", conf_directory_group: "cinder", conf_directory_mode: "0654" }
 
 - name: Install MaaS
   hosts: hosts:all_containers
-- 
2.7.0

